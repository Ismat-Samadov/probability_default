{% extends "base.html" %}

{% block title %}PD Model API - Enterprise Risk Modeling{% endblock %}

{% block content %}
<div class="hero-section fade-in">
    <div class="row align-items-center g-4">
        <div class="col-lg-8">
            <h1 class="display-4 fw-bold mb-4">
                <i class="fas fa-brain me-3"></i>Advanced PD Models
            </h1>
            <p class="lead mb-4">
                Enterprise-grade Probability of Default scoring with regulatory compliance.
                Choose your customer segment to get started with real-time risk assessment.
            </p>
            <div class="row g-3 mb-4">
                <div class="col-md-4">
                    <div class="feature-card">
                        <i class="fas fa-shield-alt text-success"></i>
                        <h6>Basel III Compliant</h6>
                        <small>Regulatory ready with 3bp minimum floors</small>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <i class="fas fa-tachometer-alt text-warning"></i>
                        <h6>Sub-100ms Response</h6>
                        <small>Real-time scoring for instant decisions</small>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <i class="fas fa-chart-line text-info"></i>
                        <h6>IFRS 9 Ready</h6>
                        <small>Automated staging and ECL calculation</small>
                    </div>
                </div>
            </div>
            <div class="d-flex flex-wrap gap-3">
                <a href="#segments" class="btn btn-light btn-lg">
                    <i class="fas fa-play me-2"></i>Get Started
                </a>
                <a href="/api/docs" target="_blank" class="btn btn-outline-light btn-lg">
                    <i class="fas fa-book me-2"></i>API Docs
                </a>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="stats-card fade-in">
                <h4 class="text-center mb-4">
                    <i class="fas fa-chart-bar me-2"></i>Model Performance
                </h4>
                <div class="stat-item">
                    <span class="stat-label">Average AUC</span>
                    <span class="stat-value">0.787</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Segments Covered</span>
                    <span class="stat-value">3/3</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Compliance Score</span>
                    <span class="stat-value">98.5%</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Response Time</span>
                    <span class="stat-value">&lt;100ms</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Model Segments Section -->
<section id="segments" class="my-5">
    <div class="text-center mb-5">
        <h2 class="fw-bold mb-3">Choose Your Model Segment</h2>
        <p class="lead mb-0">Select the appropriate model for your customer type</p>
    </div>
    
    <div class="row g-4">
        <!-- Retail Card -->
        <div class="col-lg-4">
            <div class="card h-100 segment-card fade-in" style="animation-delay: 0.1s">
                <div class="card-body text-center p-4">
                    <div class="icon-circle bg-primary mb-4">
                        <i class="fas fa-user fa-2x"></i>
                    </div>
                    <h5 class="card-title fw-bold mb-3">Retail Banking</h5>
                    <p class="card-text mb-4">
                        Score individual consumers for personal loans, credit cards, and mortgages.
                        Advanced behavioral analytics with comprehensive risk factors.
                    </p>
                    
                    <!-- Key Features -->
                    <div class="mb-4">
                        <div class="row g-2 text-start">
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>37 Risk Factors
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>Real-time Scoring
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>FICO Integration
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>Behavioral Analytics
                                </small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="metrics mb-4 p-3 rounded" style="background-color: var(--background-secondary);">
                        <div class="row g-2">
                            <div class="col-4 text-center">
                                <div class="fw-bold text-primary">0.844</div>
                                <small>AUC Score</small>
                            </div>
                            <div class="col-4 text-center">
                                <div class="fw-bold text-primary">50K+</div>
                                <small>Records</small>
                            </div>
                            <div class="col-4 text-center">
                                <div class="fw-bold text-primary">1.61%</div>
                                <small>Default Rate</small>
                            </div>
                        </div>
                    </div>
                    
                    <a href="/retail" class="btn btn-primary btn-lg w-100">
                        <i class="fas fa-calculator me-2"></i>Score Customer
                    </a>
                </div>
            </div>
        </div>

        <!-- SME Card -->
        <div class="col-lg-4">
            <div class="card h-100 segment-card fade-in" style="animation-delay: 0.2s">
                <div class="card-body text-center p-4">
                    <div class="icon-circle bg-success mb-4">
                        <i class="fas fa-building fa-2x"></i>
                    </div>
                    <h5 class="card-title fw-bold mb-3">SME Banking</h5>
                    <p class="card-text mb-4">
                        Assess small and medium enterprises with comprehensive financial analysis.
                        Industry-specific risk modeling with advanced business metrics.
                    </p>
                    
                    <!-- Key Features -->
                    <div class="mb-4">
                        <div class="row g-2 text-start">
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>31 Business Metrics
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>Industry Analysis
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>Cash Flow Models
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>Payment History
                                </small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="metrics mb-4 p-3 rounded" style="background-color: var(--background-secondary);">
                        <div class="row g-2">
                            <div class="col-4 text-center">
                                <div class="fw-bold text-success">0.747</div>
                                <small>AUC Score</small>
                            </div>
                            <div class="col-4 text-center">
                                <div class="fw-bold text-success">10K+</div>
                                <small>Companies</small>
                            </div>
                            <div class="col-4 text-center">
                                <div class="fw-bold text-success">3.99%</div>
                                <small>Default Rate</small>
                            </div>
                        </div>
                    </div>
                    
                    <a href="/sme" class="btn btn-success btn-lg w-100">
                        <i class="fas fa-calculator me-2"></i>Score Company
                    </a>
                </div>
            </div>
        </div>

        <!-- Corporate Card -->
        <div class="col-lg-4">
            <div class="card h-100 segment-card fade-in" style="animation-delay: 0.3s">
                <div class="card-body text-center p-4">
                    <div class="icon-circle bg-warning mb-4">
                        <i class="fas fa-city fa-2x"></i>
                    </div>
                    <h5 class="card-title fw-bold mb-3">Corporate Banking</h5>
                    <p class="card-text mb-4">
                        Evaluate large corporations with advanced financial ratios and market analysis.
                        Credit rating integration with comprehensive enterprise indicators.
                    </p>
                    
                    <!-- Key Features -->
                    <div class="mb-4">
                        <div class="row g-2 text-start">
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>40 Enterprise Metrics
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>Credit Ratings
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>Market Analysis
                                </small>
                            </div>
                            <div class="col-6">
                                <small>
                                    <i class="fas fa-check text-success me-1"></i>ESG Integration
                                </small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="metrics mb-4 p-3 rounded" style="background-color: var(--background-secondary);">
                        <div class="row g-2">
                            <div class="col-4 text-center">
                                <div class="fw-bold text-warning">0.770</div>
                                <small>AUC Score</small>
                            </div>
                            <div class="col-4 text-center">
                                <div class="fw-bold text-warning">2K+</div>
                                <small>Entities</small>
                            </div>
                            <div class="col-4 text-center">
                                <div class="fw-bold text-warning">1.45%</div>
                                <small>Default Rate</small>
                            </div>
                        </div>
                    </div>
                    
                    <a href="/corporate" class="btn btn-warning btn-lg w-100">
                        <i class="fas fa-calculator me-2"></i>Score Entity
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Quick Actions Section -->
<section class="my-5">
    <div class="text-center mb-5">
        <h2 class="fw-bold mb-3">Quick Actions</h2>
        <p class="lead mb-0">Additional tools for enterprise users</p>
    </div>
    
    <div class="row g-4">
        <div class="col-md-6">
            <div class="card border-primary h-100 fade-in" style="animation-delay: 0.4s">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                        <div class="icon-circle bg-primary me-3" style="width: 60px; height: 60px;">
                            <i class="fas fa-upload"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-1">Batch Processing</h5>
                            <small>Process thousands of records</small>
                        </div>
                    </div>
                    <p class="card-text mb-4">
                        Upload CSV files for portfolio-level risk assessment. 
                        Process thousands of customers in seconds with comprehensive reporting.
                    </p>
                    <div class="row g-2 mb-4">
                        <div class="col-6">
                            <small>
                                <i class="fas fa-check text-primary me-1"></i>CSV Upload
                            </small>
                        </div>
                        <div class="col-6">
                            <small>
                                <i class="fas fa-check text-primary me-1"></i>Real-time Progress
                            </small>
                        </div>
                        <div class="col-6">
                            <small>
                                <i class="fas fa-check text-primary me-1"></i>Error Handling
                            </small>
                        </div>
                        <div class="col-6">
                            <small>
                                <i class="fas fa-check text-primary me-1"></i>Export Results
                            </small>
                        </div>
                    </div>
                    <a href="/batch" class="btn btn-primary w-100">
                        <i class="fas fa-cloud-upload-alt me-2"></i>Upload File
                    </a>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card border-info h-100 fade-in" style="animation-delay: 0.5s">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                        <div class="icon-circle bg-info me-3" style="width: 60px; height: 60px;">
                            <i class="fas fa-code"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-1">API Integration</h5>
                            <small>RESTful API with full docs</small>
                        </div>
                    </div>
                    <p class="card-text mb-4">
                        RESTful API with comprehensive documentation and examples. 
                        Easy integration with your existing systems and workflows.
                    </p>
                    <div class="row g-2 mb-4">
                        <div class="col-6">
                            <small>
                                <i class="fas fa-check text-info me-1"></i>OpenAPI Spec
                            </small>
                        </div>
                        <div class="col-6">
                            <small>
                                <i class="fas fa-check text-info me-1"></i>Code Examples
                            </small>
                        </div>
                        <div class="col-6">
                            <small>
                                <i class="fas fa-check text-info me-1"></i>Rate Limiting
                            </small>
                        </div>
                        <div class="col-6">
                            <small>
                                <i class="fas fa-check text-info me-1"></i>Error Responses
                            </small>
                        </div>
                    </div>
                    <a href="/api/docs" target="_blank" class="btn btn-info w-100">
                        <i class="fas fa-book me-2"></i>View API Docs
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Technical Specifications -->
<section class="tech-specs fade-in" style="animation-delay: 0.6s">
    <h3 class="text-center mb-5">Technical Specifications</h3>
    <div class="row g-4">
        <div class="col-md-3 text-center">
            <div class="mb-3">
                <i class="fas fa-brain fa-3x text-primary mb-3"></i>
                <h6 class="fw-bold">ML Algorithms</h6>
                <small>Ensemble of Logistic Regression & Random Forest with advanced feature engineering</small>
            </div>
        </div>
        <div class="col-md-3 text-center">
            <div class="mb-3">
                <i class="fas fa-database fa-3x text-success mb-3"></i>
                <h6 class="fw-bold">Data Processing</h6>
                <small>Advanced feature engineering with 100+ variables and real-time validation</small>
            </div>
        </div>
        <div class="col-md-3 text-center">
            <div class="mb-3">
                <i class="fas fa-shield-alt fa-3x text-warning mb-3"></i>
                <h6 class="fw-bold">Compliance</h6>
                <small>Basel III floors, IFRS 9 staging, comprehensive audit trails</small>
            </div>
        </div>
        <div class="col-md-3 text-center">
            <div class="mb-3">
                <i class="fas fa-rocket fa-3x text-info mb-3"></i>
                <h6 class="fw-bold">Performance</h6>
                <small>Sub-100ms response time, 99.9% uptime SLA with auto-scaling</small>
            </div>
        </div>
    </div>
    
    <!-- Additional Tech Details -->
    <div class="row g-4 mt-4">
        <div class="col-lg-6">
            <div class="card border-0" style="background-color: transparent;">
                <div class="card-body text-center">
                    <h5 class="fw-bold mb-3">
                        <i class="fas fa-cogs me-2 text-primary"></i>Model Architecture
                    </h5>
                    <div class="row g-2">
                        <div class="col-6">
                            <div class="p-2 rounded" style="background-color: var(--background-secondary);">
                                <small class="fw-semibold">Feature Engineering</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-2 rounded" style="background-color: var(--background-secondary);">
                                <small class="fw-semibold">Ensemble Methods</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-2 rounded" style="background-color: var(--background-secondary);">
                                <small class="fw-semibold">Model Calibration</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-2 rounded" style="background-color: var(--background-secondary);">
                                <small class="fw-semibold">Risk Staging</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card border-0" style="background-color: transparent;">
                <div class="card-body text-center">
                    <h5 class="fw-bold mb-3">
                        <i class="fas fa-chart-line me-2 text-success"></i>Key Metrics
                    </h5>
                    <div class="row g-2">
                        <div class="col-6">
                            <div class="p-2 rounded" style="background-color: var(--background-secondary);">
                                <div class="fw-bold text-success">0.787</div>
                                <small>Avg AUC</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-2 rounded" style="background-color: var(--background-secondary);">
                                <div class="fw-bold text-success">62K+</div>
                                <small>Total Records</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-2 rounded" style="background-color: var(--background-secondary);">
                                <div class="fw-bold text-success">98.5%</div>
                                <small>Compliance</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-2 rounded" style="background-color: var(--background-secondary);">
                                <div class="fw-bold text-success">&lt;100ms</div>
                                <small>Response</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize intersection observer for animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);
    
    // Observe all fade-in elements
    document.querySelectorAll('.fade-in').forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
        observer.observe(el);
    });
    
    // Add hover effects to segment cards
    document.querySelectorAll('.segment-card').forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-12px) scale(1.02)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
    
    // Animate stats on scroll
    let statsAnimated = false;
    const statsCard = document.querySelector('.stats-card');
    
    if (statsCard) {
        const statsObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !statsAnimated) {
                    animateStats();
                    statsAnimated = true;
                }
            });
        }, { threshold: 0.5 });
        
        statsObserver.observe(statsCard);
    }
    
    function animateStats() {
        const statValues = document.querySelectorAll('.stat-value');
        statValues.forEach(stat => {
            const finalValue = stat.textContent;
            stat.textContent = '0';
            
            // Animate numbers
            if (finalValue.includes('.')) {
                const target = parseFloat(finalValue);
                animateValue(stat, 0, target, 1000, 3);
            } else if (finalValue.includes('K')) {
                const target = parseInt(finalValue.replace('K+', ''));
                animateValue(stat, 0, target, 1000, 0, 'K+');
            } else if (finalValue.includes('%')) {
                const target = parseFloat(finalValue.replace('%', ''));
                animateValue(stat, 0, target, 1000, 1, '%');
            } else if (finalValue.includes('<')) {
                stat.textContent = finalValue; // Special case for <100ms
            }
        });
    }
    
    function animateValue(element, start, end, duration, decimals = 0, suffix = '') {
        const range = end - start;
        const increment = range / (duration / 16);
        let current = start;
        
        const timer = setInterval(() => {
            current += increment;
            if (current >= end) {
                element.textContent = end.toFixed(decimals) + suffix;
                clearInterval(timer);
            } else {
                element.textContent = current.toFixed(decimals) + suffix;
            }
        }, 16);
    }
    
    // Add smooth scrolling for internal links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // Add loading states to CTA buttons
    document.querySelectorAll('.btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            if (this.href && !this.href.includes('#')) {
                const icon = this.querySelector('i');
                if (icon && !icon.classList.contains('fa-external-link-alt')) {
                    const originalIcon = icon.className;
                    icon.className = 'fas fa-spinner fa-spin me-2';
                    
                    // Reset after navigation or timeout
                    setTimeout(() => {
                        icon.className = originalIcon;
                    }, 2000);
                }
            }
        });
    });
    
    // Enhanced keyboard navigation
    document.addEventListener('keydown', function(e) {
        // Arrow key navigation for segment cards
        if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
            const focusedElement = document.activeElement;
            const segmentCards = Array.from(document.querySelectorAll('.segment-card a'));
            const currentIndex = segmentCards.indexOf(focusedElement);
            
            if (currentIndex !== -1) {
                e.preventDefault();
                let nextIndex;
                
                if (e.key === 'ArrowRight') {
                    nextIndex = (currentIndex + 1) % segmentCards.length;
                } else {
                    nextIndex = (currentIndex - 1 + segmentCards.length) % segmentCards.length;
                }
                
                segmentCards[nextIndex].focus();
            }
        }
    });
    
    // Add touch gestures for mobile
    if (window.innerWidth <= 768) {
        let startX = 0;
        let startY = 0;
        
        document.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
        });
        
        document.addEventListener('touchend', (e) => {
            const endX = e.changedTouches[0].clientX;
            const endY = e.changedTouches[0].clientY;
            
            const deltaX = endX - startX;
            const deltaY = endY - startY;
            
            // Swipe right to go to segments
            if (deltaX > 50 && Math.abs(deltaY) < 50) {
                const segmentsSection = document.getElementById('segments');
                if (segmentsSection) {
                    segmentsSection.scrollIntoView({ behavior: 'smooth' });
                }
            }
        });
    }
    
    // Add performance monitoring
    if ('PerformanceObserver' in window) {
        const perfObserver = new PerformanceObserver((list) => {
            list.getEntries().forEach((entry) => {
                if (entry.entryType === 'measure') {
                    console.log(`${entry.name}: ${entry.duration}ms`);
                }
            });
        });
        
        perfObserver.observe({ entryTypes: ['measure'] });
        
        // Mark key interaction points
        window.addEventListener('load', () => {
            performance.mark('page-interactive');
        });
    }

    // Theme change handler for dynamic content
    window.addEventListener('themeChanged', function(e) {
        // Update any theme-specific content
        updateThemeSpecificContent(e.detail.theme);
    });

    function updateThemeSpecificContent(theme) {
        // Update any dynamic color schemes or charts if needed
        const dynamicElements = document.querySelectorAll('[data-theme-dynamic]');
        dynamicElements.forEach(element => {
            element.setAttribute('data-current-theme', theme);
        });
    }
});
</script>
{% endblock %}